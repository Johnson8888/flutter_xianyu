{"time":"0003","tplId":"QUICKPAY@cashier-setspwd-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-setspwd-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"(function(){var a=amc.fn.docConfig;amc.fn.docConfig=function(){var b=JSON.parse(a());b.navi={naviBarColor:\"#FFFFFF\",statusBarStyle:\"dark\"};return JSON.stringify(b)}})();amc.fn.spmPageCreate(\"a283.b4034\");var getTag=amc.fn.getById;var hide=amc.fn.hide;var show=amc.fn.show;var spmPageCreate=amc.fn.spmPageCreate;var spmPageDestroy=amc.fn.spmPageDestroy;var spmExposure=amc.fn.spmExposure;var spmClick=amc.fn.spmClick;var rpc=amc.rpcData;var actionSet=\"\";var actionRepeat=\"\";var gShowServiceProtocol=true;var isFirstPage=true;function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var a=amc.fn.getNav(amc.res.navBack,\"{{return}}\",amc.isAndroid?\"{{return}}\":null,null,null,onBack,null);getTag(\"body\").insertBefore(a,getTag(\"mainBody\"));spmExposure(\"a283.b4034.c9688.d17366\");if(amc.isAndroid){getTag(\"loading\").src=amc.path+\"alipay_msp_indicator_white_loading\"}if(rpc.setSpwdType===\"quser\"){actionSet=\"/cashier/setSpwd\";actionRepeat=\"/cashier/saveSpwd\"}else{if(rpc.setSpwdType===\"complete\"){actionSet=\"/complete/spwd\";actionRepeat=\"/complete/savespwd\";gShowServiceProtocol=false}}getTag(\"mainTitle\").innerText=\"{{set_pwd}}\";getTag(\"tips\").innerText=\"{{set_pwd_tip}}\";getTag(\"spwd\").focus();if(amc.isIOS){getTag(\"body\").style.height=amc.specs.bodyHeight}else{getTag(\"body\").style.height=window.innerHeight}}function onSpwdInput(){resetErrMsg();var a=getTag(\"spwd\");if(a.value.length>=6){onFirstInput()}}function onSpwdRepeatInput(){resetErrMsg();var a=getTag(\"spwdRepeat\");var b=(a.value.length>=6);getTag(\"nextBtn\").disabled=!b;getTag(\"nextBtnTxt\").style.color=b?\"#fff\":\"#C5E4FA\";if(b){if(amc.isAndroid){document.submit({action:{name:\"loc:hideKeyboard\"}})}else{amc.fn.hideKeyboard()}}}function handleResponse(a){if(gShowServiceProtocol){show(\"agreeProtocol\")}}function onFirstInput(){var c={action:{name:actionSet}};var b=getTag(\"spwd\").value;var a={spwd:b};a.encryptType=\"RSA\";c.param=a;document.asyncSubmit(c,function(d){if(d&&d.status===\"0001\"){handleResponse(d);hide(\"spwdBox\");show(\"spwdRepeatBox\");show(\"secondPage\");isFirstPage=false;spmPageDestroy(\"a283.b4034\");spmPageCreate(\"a283.b5569\");spmExposure(\"a283.b5569.c12208.d22310\");getTag(\"mainTitle\").innerText=\"{{confirm_pay_pass}}\";getTag(\"tips\").innerText=\" \";getTag(\"spwdRepeat\").value=\"\";getTag(\"nextBtn\").disabled=true;spmExposure(\"a283.b5569.c12208.d22311\");getTag(\"spwdRepeat\").focus()}else{if(d&&d.status===\"0000\"){getTag(\"spwd\").disabled=false;getTag(\"spwd\").value=\"\";if(d.errMsg){resetErrMsg(d.errMsg)}getTag(\"spwd\").focus()}}})}function onSubmit(){spmClick(\"a283.b5569.c12208.d22310\");var d={action:{name:actionRepeat,loadtxt:\"\"}};var c=getTag(\"spwdRepeat\");var b=c.value;var a={spwd:b};a.encryptType=\"RSA\";d.param=a;document.asyncSubmit(d,function(e){if(e.status===\"0000\"){if(e.errMsg){resetErrMsg(e.errMsg)}againOnce()}amc.fn.shouldShowBtnIndicator(e,\"nextBtnTxt\",\"loading\")});amc.fn.shouldShowBtnIndicator({pageloading:\"1\"},\"nextBtnTxt\",\"loading\")}function againOnce(){getTag(\"spwd\").value=\"\";show(\"spwdBox\");hide(\"spwdRepeatBox\");hide(\"secondPage\");getTag(\"mainTitle\").innerText=\"{{set_pwd}}\";getTag(\"tips\").innerText=\"{{set_pwd_tip}}\";getTag(\"spwd\").focus();isFirstPage=true;spmPageDestroy(\"a283.b5569\");spmPageCreate(\"a283.b4034\");spmExposure(\"a283.b4034.c9688.d17366\")}function showProtocol(){document.submit({action:{name:\"loc:openweb('https://ds.alipay.com/fd-inhm9zcq/index.html','{{alipay_serve_protocol}}')\"}})}function resetErrMsg(a){a=a||\"\";if(a){show(\"errMsgBox\")}else{hide(\"errMsgBox\")}getTag(\"errMsg\").innerText=a||\"\"}function onBack(){spmClick(isFirstPage?\"a283.b4034.c9688.d17366\":\"a283.b5569.c12208.d22311\");var a={title:\"\",message:\"{{confirm_exit}}\",okButton:\"{{confirm_btn}}\",cancelButton:\"{{cancel}}\"};document.confirm(a,function(b){if(b.ok){spmPageDestroy(isFirstPage?\"a283.b4034\":\"a283.b5569\");document.submit({action:{name:\"loc:exit\"}})}})}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".err-msg-box {\n        justify-content: center;\n        display: none;\n        margin-top: 16px;\n    }\n\n    .err-msg-text {\n        color: #f4333c;\n        font-size: 15px;\n    }\n\n    .agree-label {\n        max-width: 120px;\n        color: #999;\n    }\n\n    .amc-nav-horiz-line-android {\n        background-color: #FFF;\n        height: 1PX;\n    }\n\n    .main-title {\n        font-size: 24px;\n        color: #333;\n    }\n\n    .agree-box {\n        margin-top: 16px;\n    }\n\n    .btn-box {\n        margin-top: 30px;\n    }\n\n    .pwd-box {\n        margin-top: 30px;\n    }\n\n    .amc-pd-lr {\n        padding: 0 16px;\n    }\n\n    .amc-btn-disabled-color {\n        color: #C5E4FA;\n        font-size: 18px;\n        text-align: center;\n    }\n\n    .amc-btn-primary {\n        background-color: #108ee9;\n        border: 0;\n        border-radius: 2px;\n        font-size: 18px;\n        height: 47px;\n        flex: 1.0;\n        color: #FFF;\n    }\n\n    .amc-btn-primary:active {\n        background-color: #1284D6;\n    }\n\n    .amc-btn-primary:disabled {\n        background-color: #6DBAF3;\n    }","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"mainBody","tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"id":"mainTitle","tag":"label","css":"amc-text-center amc-flex-1 main-title amc-ellipsis-2-line"}],"css":"amc-flex-center amc-v-box amc-margin-t"},{},{"tag":"div","children":[{"id":"tips","tag":"label","css":"amc-text-center amc-flex-1"}],"css":"amc-flex-center amc-margin-t-xs"},{"tag":"div","children":[{"id":"spwdBox","tag":"div","children":[{"id":"spwd","tag":"embed","value":"","src":"payspwd","type":"MQPPayPwdView","css":"amc-pwd-input amc-spwd-height","oninput":"onSpwdInput()"}],"css":"amc-spwd-box"},{"id":"spwdRepeatBox","tag":"div","children":[{"id":"spwdRepeat","tag":"embed","value":"","src":"payspwd","type":"MQPPayPwdView","css":"amc-pwd-input amc-spwd-height","oninput":"onSpwdRepeatInput()"}],"css":"amc-spwd-box amc-hidden"}],"css":"amc-v-box pwd-box"},{},{"id":"errMsgBox","tag":"div","children":[{"id":"errMsg","tag":"label","children":[{"text":"{{pwd-error-repeat}}","tag":"text"}],"css":"err-msg-text amc-ellipsis-2-line"}],"css":"err-msg-box amc-flex-center"},{},{"id":"secondPage","tag":"div","children":[{"tag":"div","children":[{"id":"agreeProtocol","tag":"div","children":[{"id":"agree","tag":"label","children":[{"text":"{{agree}}","tag":"text"}],"css":"amc-align-self-start amc-font-l amc-margin-r-xs agree-label amc-ellipsis-2-line"},{"id":"protocol","tag":"label","children":[{"text":"《{{alipay_serve_protocol}}》","tag":"text"}],"onclick":"showProtocol()","css":"amc-align-self-start amc-font-l amc-theme-color"}],"css":"agree-box amc-hidden amc-flex-center"}],"css":"amc-v-box"},{"id":"nextBtn","tag":"div","children":[{"id":"loading","tag":"img","src":"indicatior","css":"amc-loading-img amc-text-white-clolor amc-hidden"},{"id":"nextBtnTxt","tag":"label","children":[{"text":"{{next}}","tag":"text"}],"css":"amc-btn-disabled-color"}],"onclick":"onSubmit()","disabled":"true","css":"amc-flex-center amc-btn-primary btn-box"}],"css":"amc-v-box amc-hidden"}],"css":"amc-pd-lr amc-v-box"}],"css":"amc-v-box amc-pd-b"}],"onkeydown":"onKeyDown();","css":"amc-body amc-bg-white"}]},"format":"JSON","tplVersion":"5.3.8"}