{"time":"0008","tplId":"QUICKPAY@cashier-card-validate-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-card-validate-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"var getTag=amc.fn.getById;var path=amc.path+\"alipay_msp_\";var diagonal_line_png=path+\"diagonal_line\";var loading_blue_gif=path+\"loading_blue.gif\";var success_blue_norepeat_gif=path+\"success_blue.gif\";var p_array=new Array();var input_focus=false;var label_clicks=0;var has_input_changed=false;function onInputFocus(){input_focus=true}function onInputBlur(){input_focus=false}function labelClicked(){var a=getTag(\"date_input\");if(amc.isIOS){if(input_focus===true){a.blur()}else{a.focus()}}else{a.focus()}label_clicks+=1;if(label_clicks===6&&!has_input_changed){amc.fn.logError(\"keyboardNotShow\",\"clickedDate\"+label_clicks)}}function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var b=amc.fn.iNav(amc.res.arrowLeft,\"{{input_valid}}\",null,null,onBack,null);getTag(\"body\").insertBefore(b,getTag(\"iLine\"));getTag(\"diagonal_line\").src=diagonal_line_png;p_array=document.querySelectorAll(\".amc-num-item\");getTag(\"cardTitle\").innerText=amc.rpcData.cardTitle||\"{{input_expire_ccr}}\";if(flybird.rpcData.waitingTitle){getTag(\"pwd_load_text\").innerText=flybird.rpcData.waitingTitle}if(amc.isAnroid){getTag(\"p0\").onclick=labelClicked;getTag(\"p1\").onclick=labelClicked;getTag(\"p2\").onclick=labelClicked;getTag(\"p3\").onclick=labelClicked}if(amc.isPlus){getTag(\"monthLabel\").style.width=\"126px\";getTag(\"yearLabel\").style.width=\"126px\"}else{getTag(\"monthLabel\").style.width=\"97px\";getTag(\"yearLabel\").style.width=\"97px\"}var a=function(){document.invoke(\"queryInfo\",{queryKey:\"appStatus\"},function(d){var c=(d&&d.appStatus===\"foreground\");setTimeout(function(){if(!input_focus){labelClicked()}},c?80:2000);if(!c){amc.fn.logCount(\"card-validate\",\"onBackground\")}})};if(amc.isAnroid){setTimeout(a,20)}else{a()}}document.appResume=function(){if(!input_focus){setTimeout(labelClicked,10)}};function onSelect(){setTimeout(submit,1000)}function onpay_success(){getTag(\"pwd_load_gif\").src=success_blue_norepeat_gif;getTag(\"pwd_load_text\").innerText=\"{{pay_ok}}\"}function submit(){var b={action:{name:\"/cashier/cardValidate\",host:flybird.rpcData.pci_url,https:true,neec:\"6004\",loadtxt:\"\",enctype:\"application/x-www-form-urlencoded\",request_param:\"requestData\"}};var a={validate:getTag(\"date_input\").value};b.param=a;document.asyncSubmit(b,function(c){if(c.status==\"0001\"){onpay_success()}else{if(c.status==\"0000\"){getTag(\"date_input\").value=\"\";getTag(\"date_input\").focus();getTag(\"pwd_load_gif\").src=\"\";amc.fn.hide(\"pwd_load\");onDateInput()}}});getTag(\"date_input\").blur();getTag(\"pwd_load_gif\").src=loading_blue_gif;amc.fn.show(\"pwd_load\")}function onBack(){var a={message:\"{{confirm_exit}}\",okButton:\"{{confirm_btn}}\",cancelButton:\"{{cancel}}\"};document.confirm(a,function(b){if(b.ok){document.submit({action:{name:\"loc:exit\"}})}else{var c=getTag(\"date_input\");c.focus()}})}function onDateInput(){has_input_changed=true;var a=getTag(\"date_input\");var c=a.value;for(var b=0;b<c.length;b++){if(isNaN(c.substr(b,1))){a.value=\"\";c=\"\";if(amc.isIOS){a.blur()}document.toast({text:\"{{invalid_word}}\",type:\"fail\"},function(){a.focus()});break}}for(var b=0;b<4;b++){p_array[b].innerText=\"\"}for(var b=0;b<c.length&&b<4;b++){p_array[b].innerText=c.substr(b,1)}if(c.length>=4){a.value=c.substr(0,4);submit()}}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".column {\n        display: flex;\n        flex-direction: column;\n    }\n    .hidden-input {\n        height: 1px;\n        max-height: 1px;\n        max-width: 1px;\n        width: 1px;\n    }\n\n    .month-label {\n        text-align: center;\n        color: #777;\n    }\n\n    .month-box {\n        margin-top: 12px;\n    }\n\n    .fake-diagonal-line {\n        width: 20px;\n    }","tag":"text"}]},{"tag":"meta","locale":{"en_US":{"local_month":"Month","local_year":"Year"},"zh_TW":{"local_month":"月份","local_year":"年份"},"zh_HK":{"local_month":"月份","local_year":"年份"},"zh_CN":{"local_month":"月份","local_year":"年份"}},"type":"i18n"}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"iLine","tag":"div","css":"amc-1px-title-line"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","children":[{"id":"cardTitle","tag":"label","css":"amc-font-m amc-flex-1 amc-text-center amc-ellipsis-2-line"}],"css":"column amc-pd-lr"},{"tag":"div","css":"amc-abs-space-v-m"},{"id":"date_input","keyboard":"safe","tag":"input","onblur":"onInputBlur()","value":"","onfocus":"onInputFocus()","type":"number","css":"hidden-input","oninput":"onDateInput()"},{"tag":"div","children":[{"tag":"div","children":[{"id":"p0","tag":"label","css":"amc-num-item"},{"tag":"div","css":"amc-adapt-num-line"},{"id":"p1","tag":"label","css":"amc-num-item"}],"css":"amc-num-box amc-num-4-2"},{"id":"diagonal_line","tag":"img","css":"acm-diagnal"},{"tag":"div","children":[{"id":"p2","tag":"label","css":"amc-num-item"},{"tag":"div","css":"amc-adapt-num-line"},{"id":"p3","tag":"label","css":"amc-num-item"}],"css":"amc-num-box amc-num-4-2"}],"onclick":"labelClicked();","css":"amc-flex-center"},{"tag":"div","children":[{"id":"monthLabel","tag":"label","children":[{"text":"{{local_month}}","tag":"text"}],"css":"month-label amc-font-m amc-ellipsis"},{"tag":"img","css":"acm-diagnal fake-diagonal-line"},{"id":"yearLabel","tag":"label","children":[{"text":"{{local_year}}","tag":"text"}],"css":"month-label amc-font-m amc-ellipsis"}],"css":"amc-flex-center month-box"},{},{"id":"pwd_load","tag":"div","children":[{"tag":"div","css":"amc-flex-space-1"},{"id":"pwd_load_gif","tag":"embed","type":"MQPPayGifView","css":"amc-load-img"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","children":[{"id":"pwd_load_text","tag":"label","children":[{"text":"{{paying}}","tag":"text"}],"css":"amc-font-l-white amc-flex-1 amc-text-center amc-ellipsis amc-margin-lr"}],"css":"column"},{"tag":"div","css":"amc-flex-space-2"}],"css":"amc-loading-box"}],"onkeydown":"onKeyDown();","css":"amc-i-body"}]},"format":"JSON","tplVersion":"5.3.9"}